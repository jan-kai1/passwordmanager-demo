{% extends "layout.html" %}

{% block main %}


<script>
   
    // MAKE SURE USE |safe method
    var passwordlist = JSON.parse('{{ passwordlist|tojson }}') //DO NOT USE |safe WAS TRICKED BY CHATGPT |safe MARKS the object as safe not makes it safe
    console.log(passwordlist)
    document.addEventListener('DOMContentLoaded', function()
    {
         
        let generate = document.querySelector('.generate');
        let passwordinput = document.querySelector('#passwordinput');
        //create a field to check if generate button was clicked
        let generate_clicked = document.querySelector("input[name = 'generate_clicked']");
        generate.addEventListener('click', function()
        {
            event.preventDefault() //to prevent button from submitting IMPORTANT
            randompassword = passwordlist[Math.floor(Math.random() * passwordlist.length)] //math.floor makes the floor of the random float, eg 3.8 floor is 3, math.random: gives random float from 0 to 1
            passwordinput.value = randompassword;
            generate_clicked.value = true;
            

           
        });
        
        

    }  
    
    );


</script>  
<!-- Form that asks for 1. website name 2. password (provide randomly generated one for free)-->
<form method = "post">
    <input type = text name = "websitename" placeholder = 'Website name' autocomplete="off">
    <input type = 'text' id = "passwordinput" name = 'password' placeholder = 'Password' autocomplete="off">
    <!-- BUTTON TYPE BMUST BE BUTTON TO PREVENT REFRESH-->
    <button class = 'generate' >Generate a password</button>
    <input type = 'hidden' name = 'generate_clicked' value = false>
    <button type = 'submit'>Add password</button>


</form>
{% endblock %}